<h2>This document provides some explanation for fitting the logistic regression model using the XSB Prolog system.</h2>

<p>The data is provided in (semicolon-delimited) DSV format.</p>

<hr />

<p>It is loaded using the <code>load_rows/1</code> predicate <code>timestep_utilities.P</code>. This file also contains all the auxiliary predicates for semantically parsing the rows.</p>

<hr />

<p>Logistic regression is performed by the predicate <code>logistic_regression/4</code> in the Prolog file <code>regression.P</code>. It takes three input arguments:</p>

<ol>
<li>A list <code>X</code> of the lists of values of the explanatory variables;</li>
<li>A list <code>Y</code> of the corresponding values of the target variable (each of them 0 or 1);</li>
<li>The (integer) number of iterations to be performed.</li>
</ol>

<p>The list of trained coefficients is returned as the fourth argument.</p>

<p>Linear regression is performed by the predicate <code>linear_regression/3</code>, which takes arguments <code>X</code> and <code>Y</code> as above and returns a list of learned coefficients.</p>

<p>The predicate <code>lin_prediction/3</code> takes a coefficient vector and a list of lists <code>X</code> as inputs and returns a list of prediction. These can be processed by <code>rss/3</code> to compute the residual sum of squares, which can be helpful for choosing the correct explanatory variables to include.</p>

<hr />

<p>The input arguments <code>X</code> and <code>Y</code> are prepared by a predicate <code>disappeared_vectors/2</code> in <code>regression_input_maker</code>. Alternative target variables to <code>disappeared</code> such as <code>appeared</code> or <code>channel</code> are accommodated by <code>appeared_vectors/2</code> and <code>channel_vectors/2</code> respectively. The list of explanatory variables used for training is adjusted by altering the list constructed in the final line of the body of <code>explanatories/2</code>.</p>

<h3>TL;DR</h3>

<p>After starting XSB, the logistic regression model can be fitted by calling</p>

<p><code>
?-  [regression,timestep_utilities,regression_input_maker],  load_rows('db_myrica_ext_complete.csv'), disappeared_vectors(X,Y), logistic_regression(X,Y,100,Coeff).
</code></p>

<p>on the XSB command prompt.</p>

<p>The linear regression model can be fitted (and the residual sum of squares computed) by calling</p>

<p><code>
[regression, timestep_utilities, regression_input_maker],  load_rows('db_myrica_ext_complete.csv'), channel_vectors(X,Y), linear_regression(X,Y,Coeff), lin_prediction(Coeff,X,YPre), rss(YPre,Y,RSS).
</code></p>
